# CHAPTER 17. 데이터를 주고받는 네트워킹
<br>

# 1. 네트워크를 통한 통신이란

## 네트워크 연결

인터넷 상에 어떤 위치에 있는지 (IP주소)

메시지를 전송하는 장치 (Java에서는 API로 제공됨)

메시지를 읽어들이는 장치 (Java에서 API로 제공됨)
<br>
<br>

## Java에서 네트워크 프로그래밍을 하는 절차

1. 네트워크와 연결된 어떤 존재(객체) 얻어내기
2. 데이터를 읽고 싶다면 InputStream을 연결
3. 데이터를 쓰고 싶다면 OutputStream을 연결
4. 이후의 모든 작업은 입출력 프로그래밍과 마찬가지
<br>
<br>

## TCP와 UDP

- ‘패킷 데이터’를 주고받는 방식에 따라 ‘TCP 방식’과 ‘UDP 방식’으로 구분.
- 패킷(Packet) : 네트워크에서 데이터를 전송하는 데 사용하는 단위 패킷.
<br>

### TCP 방식

- 패킷 데이터를 목적지(Destination)에 전달하고, 이 패킷이 제대로 전달되었는지 **확인**한 후, 그 다음 데이터를 보내주는 방식
- 연결지향형
- 상대방이 확실히 받는 것이 보장되므로 ‘안정성’이 있다.
- 속도의 저하가 발생할 수 있다.
- 우리가 사용하는 인터넷이나 실무에서는 TCP 방식 활용
<br>
<br>

### UDP 방식

- 확인 절차를 거치지 않음. ‘일방적 전달’
- 데이터 전달은 빠르지만 안정성은 떨어짐
- UDP는 주로 동영상, 멀티미디어의 데이터를 주고받을 때 선호된다
<br>
<br>

## 소켓(Socket)

- 메시지를 주고받는 장치
- 데이터를 연결하는 중간 연결 고리로, 프로그래밍에서는 네트워크를 통해서 어떤 데이터를 주고받는 것을 흔히 ‘소켓 통신을 한다’고 표현.
- (비유) ‘종이컵 전화기’ - 종이컵이 소켓, 실이 네트워크로 연결된 상태
<br>
<br>

## 패킷(Packet)

- 네트워크를 따라서 전송되는 조각난 데이터
- 보낼 때 패킷으로 데이터를 쪼개고, 받으면 다시 조립한다.
- 이때, 데이터를 어떤 식으로 주고받고, 어떤 구조에 맞춰서 데이터에 보낼 건지에 대한 ‘약속’을 하는데, 이를 ‘프로토콜(Protocool)이라고 한다.
- 예) 인터넷 주소(URL) 앞에 있는 **‘http’**는 약속에 맞게 데이터를 보내고 받음을 의미한다.
<br>
<br>
<br>

# 2. Socket 클래스

## java.net.Socket 클래스

- 프로그래밍의 핵심은 ‘데이터를 주고받는 장치’
- Java를 이용하는 경우, 이 **Socket 클래스**에서 **객체를 만들어** 낸 후 **사용**

- Socket 클래스에서 Socket 객체를 얻어내는 것이 네트워크 프로그래밍의 핵심이라면, 나머지는 입출력 프로그래밍의 Stream의 몫
→ [java.net](http://java.net).Socket 클래스의 메소드가 담당

- InputStream - **getInputStream()** : Returns an input stream for this socket.  
OutputStream - **getOutputStream()** : Returns an output stream for this socket.
- 소켓을 이용해서 데이터를 보낸다는 것은….

Socket에서 getOutputStream()으로 데이터를 전송할 수 있는 OutputStream 객체를 얻어낸 후에 데이터를 담아 보낸다는 것을 의미.
<br>
<br>

### Socket 클래스의 생성자

- Socket 클래스의 생성자를 보면, 여러 가지 방법으로 Socket 객체를 만들어 낼 수 있다.
- 가장 많이 사용하는 것은 ‘문자열’ (상대방의 IP 정보와 숫자로 port 정보를 주는 방식으로 많이 사용됨)
<br>
<br>

### Port

- 데이터를 보내고 받는 하나의 창구, 채널, 통로
- 포트 번호는 0에서 65,536까지 존재한다.
- 0에서 1024까지는 주요 서비스에서 예약한 형태로 사용됨
- 일반적으로 이용하는 인터넷은 기본적으로 80포트를 사용
- FTP는 21번 포트를 기본으로 사용
<br>
<br>

## ServerSocket과 리스너(Listener)

- ServerSocket은 데이터를 받는 곳에서만 사용하는 추가적인 장치. (Socket은 원하는 대상과의 네트워크 연결을 담당하는 객체)
    - 서버의 역할을 하는 곳에서만 필요하고, 클라이언트에선 필요하지 않다.
    - 서버 내에서 외부에서 다른 소켓들이 연결되기를 기다리는 역할을 한다. 이런 이유 때문에 흔히 ‘리스너(Listener)’라고 부른다.
    - (비유) 종이컵 전화기 사이에 ServerSocket이 있다고 할 수 있다.

- ServerSocket 객체
    - 서버에 존재하는 객체
    - 특정 포트로 들어오는 연결을 감지한다
    - ServerSocket 객체를 만들 때엔 포트 번호만 있으면 된다.
    (서버 쪽에서만 필요하므로, 외부에 연결할 때 필요한 정보는 없음)
    - 사용자의 연결이 들어오면 ServerSocket의 **accept() 메소드**를 통해서 연결된 Socket을 구한다(받아들인다).
    
- ServerSocket의 accpet() 메소드
    - 외부에서 연결되는 소켓 연결을 기다리게 하는 메소드
    - ServerSocket은 외부에서 **소켓이 연결이 들어오면(accept()) java.net.Socket 객체를 반환**하며, 상대방과 연결 정보를 그대로 가진 Socket 객체를 만들어낸다.
    
- Socket 연결해서 통신하는 구조
1. 서버 쪽에서 ServerSocket 객체를 생성하고 연결을 기다린다.
2. 외부에서 접속하는 사람은 Socket 객체를 만들어서 서버에 접속을 시도한다.
3. 서버에서 accept() 메소드가 실행되면서 클라이언트와 연결된 Socket 객체가 만들어짐 
<br>
<br>
<br>


// 추가 예정

### **모든 네트워크 관련 API는 IOException을 발생시킨다.**

-> 따라서 **try ~ catch ~ finally 로 처리**해야 함

<br>

* 인터넷 브라우저는 하나의 소켓 발생기.

    - 인터넷으로 연결하는 것은, 외부에서 서버에 소켓을 연결하는 것과 같은 작업이다.

    - 다만 브라우저에는 내부적으로 ‘디스플레이’ 기능이 있기 때문에 제대로 동작하는 경우 사용자에게 화면을 보여준다.

